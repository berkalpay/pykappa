<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      pykappa.rule — PyKappa
    
  </title>

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=ee3c7c2a" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pykappa.pattern" href="pykappa.pattern.html" />
    <link rel="prev" title="pykappa.mixture" href="pykappa.mixture.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-pykappa.rule">
<span id="pykappa-rule"></span><h1>pykappa.rule<a class="headerlink" href="#module-pykappa.rule" title="Link to this heading">¶</a></h1>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pykappa.rule.kinetic_to_stochastic_on_rate" title="pykappa.rule.kinetic_to_stochastic_on_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinetic_to_stochastic_on_rate</span></code></a>([k_on, ...])</p></td>
<td><p>Convert a kinetic on-rate constant to a stochastic one.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pykappa.rule.KappaRule" title="pykappa.rule.KappaRule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KappaRule</span></code></a>(left, right, stochastic_rate)</p></td>
<td><p>Standard Kappa rule with left-hand side, right-hand side, and rate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pykappa.rule.KappaRuleBimolecular" title="pykappa.rule.KappaRuleBimolecular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KappaRuleBimolecular</span></code></a>(left, right, ...)</p></td>
<td><p>Bimolecular Kappa rule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pykappa.rule.KappaRuleUnimolecular" title="pykappa.rule.KappaRuleUnimolecular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KappaRuleUnimolecular</span></code></a>(left, right, ...)</p></td>
<td><p>Unimolecular Kappa rule that acts within a single component.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pykappa.rule.Rule" title="pykappa.rule.Rule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Rule</span></code></a>()</p></td>
<td><p>Abstract base class for all rule types.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pykappa.rule.</span></span><span class="sig-name descname"><span class="pre">KappaRule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule" title="Link to this definition">¶</a></dt>
<dd><p>Standard Kappa rule with left-hand side, right-hand side, and rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>right</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>stochastic_rate</strong> (<a class="reference internal" href="pykappa.algebra.html#pykappa.algebra.Expression" title="pykappa.algebra.Expression"><em>Expression</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.left">
<span class="sig-name descname"><span class="pre">left</span></span><a class="headerlink" href="#pykappa.rule.KappaRule.left" title="Link to this definition">¶</a></dt>
<dd><p>Left-hand side pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern">pykappa.pattern.Pattern</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.right">
<span class="sig-name descname"><span class="pre">right</span></span><a class="headerlink" href="#pykappa.rule.KappaRule.right" title="Link to this definition">¶</a></dt>
<dd><p>Right-hand side pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern">pykappa.pattern.Pattern</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.stochastic_rate">
<span class="sig-name descname"><span class="pre">stochastic_rate</span></span><a class="headerlink" href="#pykappa.rule.KappaRule.stochastic_rate" title="Link to this definition">¶</a></dt>
<dd><p>Rate expression for the rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.algebra.html#pykappa.algebra.Expression" title="pykappa.algebra.Expression">pykappa.algebra.Expression</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.from_kappa">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_kappa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.from_kappa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.from_kappa" title="Link to this definition">¶</a></dt>
<dd><p>Parse a single Kappa rule from string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kappa_str</strong> (<em>str</em>) – Kappa rule string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed rule.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If the string represents more than one rule.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Self</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.kappa_str">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kappa_str</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></span><a class="headerlink" href="#pykappa.rule.KappaRule.kappa_str" title="Link to this definition">¶</a></dt>
<dd><p>The rule representation in Kappa format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Kappa string representation of the rule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">left</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><span class="pre">Pattern</span></a></span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.list_from_kappa">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">list_from_kappa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.list_from_kappa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.list_from_kappa" title="Link to this definition">¶</a></dt>
<dd><p>Parse Kappa string into a list of rules.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Forward-reverse rules (with “&lt;-&gt;”) represent two rules.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kappa_str</strong> (<em>str</em>) – Kappa rule string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of parsed rules.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<em>Self</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.n_embeddings">
<span class="sig-name descname"><span class="pre">n_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.n_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.n_embeddings" title="Link to this definition">¶</a></dt>
<dd><p>Count embeddings in the mixture.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This doesn’t do any symmetry correction, though <cite>System</cite>
applies this correction when calculating rule reactivities.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.Mixture" title="pykappa.mixture.Mixture"><em>Mixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of ways to embed all rule components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.n_symmetries">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">n_symmetries</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#pykappa.rule.KappaRule.n_symmetries" title="Link to this definition">¶</a></dt>
<dd><p>The number of distinct automorphisms of the graph containing both left- and
right-hand side agents, augmented with edges between positionally corresponding agents.
For example, if a rule looks like “l1(…), l2(…) -&gt; r1(…), r2(…)”,
this method draws artifical edges between l1 and r1, and between l2 and r2,
then returns the number of symmetries of the resulting graph by counting
how many ways it can be mapped onto itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of symmetries exhibited by the rule.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.rate">
<span class="sig-name descname"><span class="pre">rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.rate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the stochastic rate expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="pykappa.system.html#pykappa.system.System" title="pykappa.system.System"><em>System</em></a>) – System containing variables for rate evaluation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated rate value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.reactivity">
<span class="sig-name descname"><span class="pre">reactivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.reactivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.reactivity" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the total reactivity of this rule in the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="pykappa.system.html#pykappa.system.System" title="pykappa.system.System"><em>System</em></a>) – System containing the mixture and parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Product of number of embeddings and reaction rate, accounting
for rule symmetry.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">right</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><span class="pre">Pattern</span></a></span><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRule.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRule.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRule.select" title="Link to this definition">¶</a></dt>
<dd><p>Select agents in the mixture and specify the update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can change the internal states of agents in the mixture but
records everything else in the MixtureUpdate.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.ComponentMixture" title="pykappa.mixture.ComponentMixture"><em>ComponentMixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MixtureUpdate specifying the transformation, or None for invalid match.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.MixtureUpdate" title="pykappa.mixture.MixtureUpdate"><em>MixtureUpdate</em></a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">stochastic_rate</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="pykappa.algebra.html#pykappa.algebra.Expression" title="pykappa.algebra.Expression"><span class="pre">Expression</span></a></span><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleBimolecular">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pykappa.rule.</span></span><span class="sig-name descname"><span class="pre">KappaRuleBimolecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleBimolecular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleBimolecular" title="Link to this definition">¶</a></dt>
<dd><p>Bimolecular Kappa rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>right</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>stochastic_rate</strong> (<a class="reference internal" href="pykappa.algebra.html#pykappa.algebra.Expression" title="pykappa.algebra.Expression"><em>Expression</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleBimolecular.component_weights">
<span class="sig-name descname"><span class="pre">component_weights</span></span><a class="headerlink" href="#pykappa.rule.KappaRuleBimolecular.component_weights" title="Link to this definition">¶</a></dt>
<dd><p>Cache of embedding weights per component.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleBimolecular.kappa_str">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kappa_str</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></span><a class="headerlink" href="#pykappa.rule.KappaRuleBimolecular.kappa_str" title="Link to this definition">¶</a></dt>
<dd><p>The rule representation in Kappa format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Kappa string representation with bimolecular rate syntax.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleBimolecular.n_embeddings">
<span class="sig-name descname"><span class="pre">n_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleBimolecular.n_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleBimolecular.n_embeddings" title="Link to this definition">¶</a></dt>
<dd><p>Count embeddings in the mixture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.ComponentMixture" title="pykappa.mixture.ComponentMixture"><em>ComponentMixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total number of valid bimolecular embeddings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleBimolecular.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleBimolecular.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleBimolecular.select" title="Link to this definition">¶</a></dt>
<dd><p>Select agents in the mixture and specify the update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>n_embeddings must be called before this method so that the
component_weights cache is up-to-date.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.ComponentMixture" title="pykappa.mixture.ComponentMixture"><em>ComponentMixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MixtureUpdate specifying the transformation, or None for invalid match.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.MixtureUpdate" title="pykappa.mixture.MixtureUpdate"><em>MixtureUpdate</em></a> | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleUnimolecular">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pykappa.rule.</span></span><span class="sig-name descname"><span class="pre">KappaRuleUnimolecular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stochastic_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleUnimolecular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleUnimolecular" title="Link to this definition">¶</a></dt>
<dd><p>Unimolecular Kappa rule that acts within a single component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>right</strong> (<a class="reference internal" href="pykappa.pattern.html#pykappa.pattern.Pattern" title="pykappa.pattern.Pattern"><em>Pattern</em></a>)</p></li>
<li><p><strong>stochastic_rate</strong> (<a class="reference internal" href="pykappa.algebra.html#pykappa.algebra.Expression" title="pykappa.algebra.Expression"><em>Expression</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleUnimolecular.component_weights">
<span class="sig-name descname"><span class="pre">component_weights</span></span><a class="headerlink" href="#pykappa.rule.KappaRuleUnimolecular.component_weights" title="Link to this definition">¶</a></dt>
<dd><p>Cache of embedding weights per component.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleUnimolecular.kappa_str">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kappa_str</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></span><a class="headerlink" href="#pykappa.rule.KappaRuleUnimolecular.kappa_str" title="Link to this definition">¶</a></dt>
<dd><p>Get the rule representation in Kappa format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Kappa string representation with unimolecular rate syntax.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleUnimolecular.n_embeddings">
<span class="sig-name descname"><span class="pre">n_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleUnimolecular.n_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleUnimolecular.n_embeddings" title="Link to this definition">¶</a></dt>
<dd><p>Count embeddings in the mixture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.ComponentMixture" title="pykappa.mixture.ComponentMixture"><em>ComponentMixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total number of valid embeddings across all components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.KappaRuleUnimolecular.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#KappaRuleUnimolecular.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.KappaRuleUnimolecular.select" title="Link to this definition">¶</a></dt>
<dd><p>Select agents in the mixture and specify the update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>n_embeddings must be called before this method so that the
component_weights cache is up-to-date.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.ComponentMixture" title="pykappa.mixture.ComponentMixture"><em>ComponentMixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MixtureUpdate specifying the transformation, or None for invalid match.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.MixtureUpdate" title="pykappa.mixture.MixtureUpdate"><em>MixtureUpdate</em></a> | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pykappa.rule.Rule">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pykappa.rule.</span></span><span class="sig-name descname"><span class="pre">Rule</span></span><a class="reference internal" href="../../_modules/pykappa/rule.html#Rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.Rule" title="Link to this definition">¶</a></dt>
<dd><p>Abstract base class for all rule types.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.Rule.n_embeddings">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">n_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#Rule.n_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.Rule.n_embeddings" title="Link to this definition">¶</a></dt>
<dd><p>Count the number of ways this rule can be applied to the mixture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.Mixture" title="pykappa.mixture.Mixture"><em>Mixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of valid embeddings for this rule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.Rule.rate">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#Rule.rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.Rule.rate" title="Link to this definition">¶</a></dt>
<dd><p>Get the stochastic rate of the rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="pykappa.system.html#pykappa.system.System" title="pykappa.system.System"><em>System</em></a>) – System containing parameters for rate evaluation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stochastic rate constant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.Rule.reactivity">
<span class="sig-name descname"><span class="pre">reactivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#Rule.reactivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.Rule.reactivity" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the total reactivity of this rule in the given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<a class="reference internal" href="pykappa.system.html#pykappa.system.System" title="pykappa.system.System"><em>System</em></a>) – System containing the mixture and parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Product of number of embeddings and reaction rate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pykappa.rule.Rule.select">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#Rule.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.Rule.select" title="Link to this definition">¶</a></dt>
<dd><p>Select agents in the mixture and specify the update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t modify anything in mixture directly except for changing
internal sites of agents. A null event is represented by returning None.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixture</strong> (<a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.Mixture" title="pykappa.mixture.Mixture"><em>Mixture</em></a>) – Current mixture state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MixtureUpdate specifying the transformation, or None for null event.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pykappa.mixture.html#pykappa.mixture.MixtureUpdate" title="pykappa.mixture.MixtureUpdate"><em>MixtureUpdate</em></a> | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pykappa.rule.kinetic_to_stochastic_on_rate">
<span class="sig-prename descclassname"><span class="pre">pykappa.rule.</span></span><span class="sig-name descname"><span class="pre">kinetic_to_stochastic_on_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecularity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pykappa/rule.html#kinetic_to_stochastic_on_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pykappa.rule.kinetic_to_stochastic_on_rate" title="Link to this definition">¶</a></dt>
<dd><p>Convert a kinetic on-rate constant to a stochastic one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_on</strong> (<em>float</em>) – Kinetic on-rate constant.</p></li>
<li><p><strong>volume</strong> (<em>float</em>) – Reaction volume.</p></li>
<li><p><strong>molecularity</strong> (<em>int</em>) – Number of reactants.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stochastic rate constant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo of PyKappa"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">PyKappa</a></h1>











<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pykappa.system.html">pykappa.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="pykappa.mixture.html">pykappa.mixture</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pykappa.rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="pykappa.pattern.html">pykappa.pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="pykappa.grammar.html">pykappa.grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="pykappa.algebra.html">pykappa.algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="pykappa.utils.html">pykappa.utils</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">API reference</a><ul>
      <li>Previous: <a href="pykappa.mixture.html" title="previous chapter">pykappa.mixture</a></li>
      <li>Next: <a href="pykappa.pattern.html" title="next chapter">pykappa.pattern</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, PyKappa Developers.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/api/generated/pykappa.rule.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/berkalpay/pykappa" class="github">
        <img src="../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>